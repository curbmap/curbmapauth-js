machine:
  environment:
    PATH: "${PATH}:${HOME}/${CIRCLE_PROJECT_REPONAME}/node_modules/.bin"
  node:
    version:
      6.1.0
dependencies:
  override:
    - cd ~/curbmapauth-js && npm install
deployment:
  production:
    branch: master
    commands:
      - cd ~/curbmapauth-js && tar -c -v --exclude node_modules -f curbmapauth-js.tar *
      - cd ~/curbmapauth-js && bzip2 curbmapauth-js.tar
      - scp -r ~/curbmapauth-js/curbmapauth-js.tar.bz2 ec2-user@curbmap.com:~/tommydeploy/curbmapauth-js/
      - ssh ec2-user@curbmap.com "cd ~/tommydeploy && ./runscript.sh build > /dev/null &"
